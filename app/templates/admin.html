<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light dark" />
    <title>{{ title|capitalize }}</title>
    
    <meta name="description" content="An administrator panel" />

    <!-- Pico.css -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2.0.6/css/pico.classless.min.css"
    />
  </head>

  <body>
    <!-- Header -->
    <header>
      <hgroup>
        <h1>{{ title|capitalize }}</h1>
        <p>A class-less example, without dependencies.</p>
      </hgroup>
      <nav>
        <ul>
          <li><a href="#" data-theme-switcher="auto">Auto</a></li>
          <li><a href="#" data-theme-switcher="light">Light</a></li>
          <li><a href="#" data-theme-switcher="dark">Dark</a></li>
        </ul>
      </nav>
    </header>
    <!-- ./ Header -->

    <!-- Main -->
    <main>
      <section>
        <table>
          <thead>
            <tr>
              {% for key in data[0] %}
              <th>{{ key }}</th>
              {% endfor %}
              <th></th>
            </tr>
          </thead>
          <tbody>
            {% for row in data %}
            <tr>
              {% for key in row %}
              <td>{{ row[key] }}</td>
              {% endfor %}
              <td><a href="{{ request.url + '/' + row[id_str] | string }}">{{ action_label }}</a></td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </section>

    <!-- Minimal theme switcher -->
    <script>
    /*!
     * Minimal theme switcher
     *
     * Pico.css - https://picocss.com
     * Copyright 2019-2024 - Licensed under MIT
     */

    const themeSwitcher = {
      // Config
      _scheme: "auto",
      menuTarget: "details.dropdown",
      buttonsTarget: "a[data-theme-switcher]",
      buttonAttribute: "data-theme-switcher",
      rootAttribute: "data-theme",
      localStorageKey: "picoPreferredColorScheme",

      // Init
      init() {
        this.scheme = this.schemeFromLocalStorage;
        this.initSwitchers();
      },

      // Get color scheme from local storage
      get schemeFromLocalStorage() {
        return window.localStorage?.getItem(this.localStorageKey) ?? this._scheme;
      },

      // Preferred color scheme
      get preferredColorScheme() {
        return window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
      },

      // Init switchers
      initSwitchers() {
        const buttons = document.querySelectorAll(this.buttonsTarget);
        buttons.forEach((button) => {
          button.addEventListener(
            "click",
            (event) => {
              event.preventDefault();
              // Set scheme
              this.scheme = button.getAttribute(this.buttonAttribute);
              // Close dropdown
              document.querySelector(this.menuTarget)?.removeAttribute("open");
            },
            false
          );
        });
      },

      // Set scheme
      set scheme(scheme) {
        if (scheme == "auto") {
          this._scheme = this.preferredColorScheme;
        } else if (scheme == "dark" || scheme == "light") {
          this._scheme = scheme;
        }
        this.applyScheme();
        this.schemeToLocalStorage();
      },

      // Get scheme
      get scheme() {
        return this._scheme;
      },

      // Apply scheme
      applyScheme() {
        document.querySelector("html")?.setAttribute(this.rootAttribute, this.scheme);
      },

      // Store scheme to local storage
      schemeToLocalStorage() {
        window.localStorage?.setItem(this.localStorageKey, this.scheme);
      },
    };

    // Init
    themeSwitcher.init();
    </script>
  </body>
</html>
